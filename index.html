<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CoreBox</title>
  <style>
    body {
      font-family: monospace;
      background: #111;
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }
    .main {
      display: flex;
      flex-direction: row;
      gap: 10px;
    }
    .inventory {
      display: grid;
      grid-template-columns: repeat(3, 80px);
      gap: 6px;
      margin-bottom: 10px;
      border: 1px solid #444;
      padding: 6px;
      border-radius: 8px;
    }
    .left-slots, .right-slots {
      display: grid;
      grid-template-columns: 1fr;
      gap: 6px;
    }
    .center-panel {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .slot, .special-slot {
      background: #222;
      border: 2px solid #888;
      width: 70px;
      height: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      text-align: center;
      flex-direction: column;
      user-select: none;
      box-shadow: 0 0 4px #000;
      border-radius: 5px;
      cursor: pointer;
    }
    .special-slot {
      background: #004;
      width: 160px;
      height: 40px;
      font-size: 12px;
      margin-bottom: 10px;
      cursor: default;
    }
    button {
      padding: 10px 20px;
      background: #0f0;
      border: none;
      color: #000;
      font-weight: bold;
      cursor: pointer;
      margin: 5px;
    }
    #timeDisplay {
      margin: 10px;
      font-size: 14px;
    }
    #logBox {
      margin-top: 10px;
      width: 100%;
      max-width: 400px;
      height: 120px;
      background: #222;
      overflow-y: auto;
      font-size: 12px;
      padding: 5px;
      border-radius: 6px;
      border: 1px solid #444;
    }
  </style>
</head>
<body>
  <h1>CoreBox</h1>
  <div id="timeDisplay">‚è∞ –î–µ–Ω—å</div>
  <div class="main">
    <div class="left-slots" id="leftSlots"></div>
    <div class="center-panel">
      <div class="special-slot" id="aiSlot">ü§ñ –ò–ò –∞–∫—Ç–∏–≤–µ–Ω</div>
      <div class="inventory" id="inventory"></div>
      <button id="mineBtn">–î–æ–±—ã—Ç—å —Ä–µ—Å—É—Ä—Å—ã</button>
      <div id="logBox"></div>
    </div>
    <div class="right-slots" id="rightSlots"></div>
  </div>

  <script>
    const inventory = { '–ò–ò': 1, '–£–≥–æ–ª—å': 0, '–ú—É—Å–æ—Ä': 0 };
    const maxSlots = 9;
    let coalEnabled = false;
    let gameTime = 15;
    let isDay = true;
    let passiveCounter = 0;

    const leftPanelItems = ['–¢–≠–¶', '', '', '', ''];
    const rightPanelItems = ['', '', '', '', ''];

    function log(message) {
      const box = document.getElementById('logBox');
      box.innerHTML += `üü¢ ${message}<br>`;
      box.scrollTop = box.scrollHeight;
    }

    function updateTimeDisplay() {
      const icon = isDay ? 'üåû' : 'üåô';
      document.getElementById('timeDisplay').innerText = `${icon} ${isDay ? '–î–µ–Ω—å' : '–ù–æ—á—å'} ‚Äî ${gameTime}—Å –æ—Å—Ç–∞–ª–æ—Å—å`;
    }

    function render() {
      const invDiv = document.getElementById('inventory');
      const leftDiv = document.getElementById('leftSlots');
      const rightDiv = document.getElementById('rightSlots');
      const aiSlot = document.getElementById('aiSlot');

      invDiv.innerHTML = '';
      leftDiv.innerHTML = '';
      rightDiv.innerHTML = '';

      let renderedSlots = 0;
      Object.keys(inventory).forEach(name => {
        if (name === '–ò–ò') return;
        const slot = document.createElement('div');
        slot.className = 'slot';
        slot.dataset.resource = name;
        slot.innerHTML = `${name} x${inventory[name]}`;
        if (name === '–£–≥–æ–ª—å') {
          slot.style.borderColor = coalEnabled ? 'lime' : '#888';
          slot.addEventListener('click', () => {
            if (coalEnabled) {
              coalEnabled = false;
              log('–£–≥–æ–ª—å üî• –≤—ã–∫–ª—é—á–µ–Ω');
              render();
            } else if (inventory['–£–≥–æ–ª—å'] > 0) {
              coalEnabled = true;
              inventory['–£–≥–æ–ª—å']--;
              log('–£–≥–æ–ª—å üî• –≤–∫–ª—é—á—ë–Ω (‚àí1)');
              render();
            }
          });
        }
        invDiv.appendChild(slot);
        renderedSlots++;
      });

      for (let i = renderedSlots; i < maxSlots; i++) {
        const slot = document.createElement('div');
        slot.className = 'slot';
        slot.innerText = '[–ø—É—Å—Ç–æ]';
        invDiv.appendChild(slot);
      }

      leftPanelItems.forEach(name => {
        const slot = document.createElement('div');
        slot.className = 'slot';
        slot.innerText = name || '[–ø—É—Å—Ç–æ]';
        leftDiv.appendChild(slot);
      });

      rightPanelItems.forEach(name => {
        const slot = document.createElement('div');
        slot.className = 'slot';
        slot.innerText = name || '[–ø—É—Å—Ç–æ]';
        rightDiv.appendChild(slot);
      });

      const aiActive = isDay || (coalEnabled && inventory['–£–≥–æ–ª—å'] >= 0);
      aiSlot.innerText = aiActive ? 'ü§ñ –ò–ò –∞–∫—Ç–∏–≤–µ–Ω' : 'üõë –ò–ò –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω';

      updateTimeDisplay();
    }

    document.getElementById('mineBtn').addEventListener('click', () => {
      const aiActive = isDay || (coalEnabled && inventory['–£–≥–æ–ª—å'] >= 0);
      if (!aiActive || (!isDay && !coalEnabled)) return;
      const coalChance = coalEnabled ? 0.07 : 0.04;
      const trashChance = coalEnabled ? 0.02 : 0.01;

      if (Math.random() < coalChance) {
        inventory['–£–≥–æ–ª—å']++;
        log('–ù–∞–π–¥–µ–Ω —É–≥–æ–ª—å ü™®');
      }
      if (Math.random() < trashChance) {
        inventory['–ú—É—Å–æ—Ä']++;
        log('–ù–∞–π–¥–µ–Ω –º—É—Å–æ—Ä ‚ôªÔ∏è');
      }
      render();
    });

    setInterval(() => {
      gameTime--;
      if (gameTime <= 0) {
        gameTime = 15;
        isDay = !isDay;
        if (!isDay && coalEnabled) {
          if (inventory['–£–≥–æ–ª—å'] > 0) {
            inventory['–£–≥–æ–ª—å']--;
            log('–ù–∞—Å—Ç—É–ø–∏–ª–∞ –Ω–æ—á—å üåô ‚Äî —Å–≥–æ—Ä–µ–ª 1 —É–≥–æ–ª—å');
          } else {
            coalEnabled = false;
            log('–ù–∞—Å—Ç—É–ø–∏–ª–∞ –Ω–æ—á—å üåô ‚Äî —É–≥–æ–ª—å –∑–∞–∫–æ–Ω—á–∏–ª—Å—è, –ò–ò –æ—Ç–∫–ª—é—á—ë–Ω');
          }
        } else {
          log(isDay ? '–ù–∞—Å—Ç—É–ø–∏–ª –¥–µ–Ω—å üåû' : '–ù–∞—Å—Ç—É–ø–∏–ª–∞ –Ω–æ—á—å üåô');
        }
      }

      passiveCounter++;
      if (passiveCounter >= 7) {
        passiveCounter = 0;
        const aiActive = isDay || (coalEnabled && inventory['–£–≥–æ–ª—å'] >= 0);
        if (!isDay && !coalEnabled) return;
        if (aiActive) {
          const coalChance = coalEnabled ? 0.01 : 0.005;
          const trashChance = coalEnabled ? 0.01 : 0.005;
          if (Math.random() < coalChance) {
            inventory['–£–≥–æ–ª—å']++;
            log('–ü–∞—Å—Å–∏–≤–Ω–æ –Ω–∞–π–¥–µ–Ω —É–≥–æ–ª—å ü™®');
          }
          if (Math.random() < trashChance) {
            inventory['–ú—É—Å–æ—Ä']++;
            log('–ü–∞—Å—Å–∏–≤–Ω–æ –Ω–∞–π–¥–µ–Ω –º—É—Å–æ—Ä ‚ôªÔ∏è');
          }
        }
      }

      render();
    }, 1000);

    render();
  </script>
</body>
</html>
